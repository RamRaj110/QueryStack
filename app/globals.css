@import "tailwindcss";
@import "tw-animate-css";
@plugin "@tailwindcss/typography";

@theme {
  --font-inter: var(--font-inter);
  --font-outfit: var(--font-outfit);

  --color-background: var(--background);
  --color-foreground: var(--foreground);

  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);

  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);

  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);

  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);

  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);

  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);

  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
}

@custom-variant dark (&:is(.dark *));

@layer base {
  :root {
    /* --- PROFESSIONAL MODERN PALETTE (LIGHT) --- */
    --background: oklch(1 0 0);
    --foreground: oklch(0.13 0.04 260);

    --card: oklch(0.99 0.005 260);
    --card-foreground: oklch(0.13 0.04 260);

    --popover: oklch(1 0 0);
    --popover-foreground: oklch(0.13 0.04 260);

    --primary: oklch(0.55 0.16 255);
    --primary-foreground: oklch(1 0 0);

    --secondary: oklch(0.97 0.015 255);
    --secondary-foreground: oklch(0.4 0.12 255);

    --muted: oklch(0.97 0.01 260);
    --muted-foreground: oklch(0.45 0.03 260);

    --accent: oklch(0.97 0.015 255);
    --accent-foreground: oklch(0.4 0.12 255);

    --destructive: oklch(0.6 0.18 20);
    --destructive-foreground: oklch(1 0 0);

    --border: oklch(0.93 0.01 260);
    --input: oklch(0.93 0.01 260);
    --ring: oklch(0.55 0.16 255);

    --radius: 0.75rem;

    /* Sidebar - Light */
    --sidebar: oklch(0.99 0.005 260);
    --sidebar-foreground: oklch(0.13 0.04 260);
    --sidebar-primary: oklch(0.55 0.16 255);
    --sidebar-primary-foreground: oklch(1 0 0);
    --sidebar-accent: oklch(0.97 0.015 255);
    --sidebar-accent-foreground: oklch(0.4 0.12 255);
    --sidebar-border: oklch(0.93 0.01 260);
    --sidebar-ring: oklch(0.55 0.16 255);
  }

  .dark {
    /* --- DEEP OBISIDIAN NAVY (DARK) --- */
    --background: oklch(0.11 0.03 260);
    --foreground: oklch(0.98 0.01 260);

    --card: oklch(0.15 0.04 260);
    --card-foreground: oklch(0.98 0.01 260);

    --popover: oklch(0.15 0.04 260);
    --popover-foreground: oklch(0.98 0.01 260);

    --primary: oklch(0.65 0.18 250);
    --primary-foreground: oklch(0.11 0.03 260);

    --secondary: oklch(0.20 0.04 260);
    --secondary-foreground: oklch(0.98 0.01 260);

    --muted: oklch(0.2 0.04 260);
    --muted-foreground: oklch(0.65 0.05 260);

    --accent: oklch(0.2 0.04 260);
    --accent-foreground: oklch(0.98 0.01 260);

    --destructive: oklch(0.4 0.15 25);
    --destructive-foreground: oklch(0.98 0.01 260);

    --border: oklch(0.25 0.04 260);
    --input: oklch(0.25 0.04 260);
    --ring: oklch(0.65 0.18 250);

    /* Sidebar - Dark */
    --sidebar: oklch(0.15 0.04 260);
    --sidebar-foreground: oklch(0.98 0.01 260);
    --sidebar-primary: oklch(0.65 0.18 250);
    --sidebar-primary-foreground: oklch(0.11 0.03 260);
    --sidebar-accent: oklch(0.2 0.04 260);
    --sidebar-accent-foreground: oklch(0.98 0.01 260);
    --sidebar-border: oklch(0.25 0.04 260);
    --sidebar-ring: oklch(0.65 0.18 250);
  }
}


/* 3. Base Styles */
@layer base {
  html {
    /* Smooth transition when toggling themes */
    transition: color 0.2s ease-out, background-color 0.2s ease-out;
  }
  body {
    @apply bg-background text-foreground antialiased;
  }
}

@theme inline {
  --radius-sm: calc(var(--radius) - 4px);

  --radius-md: calc(var(--radius) - 2px);

  --radius-lg: var(--radius);

  --radius-xl: calc(var(--radius) + 4px);

  --color-background: var(--background);

  --color-foreground: var(--foreground);

  --color-card: var(--card);

  --color-card-foreground: var(--card-foreground);

  --color-popover: var(--popover);

  --color-popover-foreground: var(--popover-foreground);

  --color-primary: var(--primary);

  --color-primary-foreground: var(--primary-foreground);

  --color-secondary: var(--secondary);

  --color-secondary-foreground: var(--secondary-foreground);

  --color-muted: var(--muted);

  --color-muted-foreground: var(--muted-foreground);

  --color-accent: var(--accent);

  --color-accent-foreground: var(--accent-foreground);

  --color-destructive: var(--destructive);

  --color-border: var(--border);

  --color-input: var(--input);

  --color-ring: var(--ring);

  --color-chart-1: var(--chart-1);

  --color-chart-2: var(--chart-2);

  --color-chart-3: var(--chart-3);

  --color-chart-4: var(--chart-4);

  --color-chart-5: var(--chart-5);

  --color-sidebar: var(--sidebar);

  --color-sidebar-foreground: var(--sidebar-foreground);

  --color-sidebar-primary: var(--sidebar-primary);

  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);

  --color-sidebar-accent: var(--sidebar-accent);

  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);

  --color-sidebar-border: var(--sidebar-border);

  --color-sidebar-ring: var(--sidebar-ring);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

@layer utilities {
  /* --- 1. TOOLBAR & BUTTONS --- */
  .mdxeditor-toolbar {
    @apply !bg-background !border-b !border-border !p-2 !flex !gap-1 !items-center !flex-wrap;
  }

  .mdxeditor-toolbar button {
    @apply !text-muted-foreground !rounded-md !p-1.5 !transition-colors;
  }
  .mdxeditor-toolbar button:hover {
    @apply !bg-secondary !text-foreground;
  }
  .mdxeditor-toolbar button[data-state="on"] {
    @apply !bg-primary/10 !text-primary;
  }

  /* --- 2. DROPDOWNS (Block Type, Code Language) --- */
  .mdxeditor-select-trigger {
    @apply !flex !items-center !justify-between !gap-2 !rounded-md !px-3 !py-1.5 !text-sm !font-medium !min-w-[120px] !text-muted-foreground;
  }
  .mdxeditor-select-trigger:hover {
    @apply !bg-secondary/50 !text-foreground;
  }

  .mdxeditor-select-content {
    /* Fixed: Removed restrictive heights/widths that caused layout break */
    @apply !bg-popover !border !border-border !rounded-md !shadow-md !p-1 !mt-1 !z-50;
  }

  .mdxeditor-select-item {
    @apply !px-3 !py-2 !text-sm !text-popover-foreground !cursor-pointer !rounded-sm;
  }
  .mdxeditor-select-item:hover {
    @apply !bg-accent !text-accent-foreground;
  }

  /* --- 3. POPUPS / DIALOGS (The Link/URL Box) --- */
  /* This fixes the "overlap" issue */
  .mdxeditor-popup-container {
    @apply !bg-popover !text-popover-foreground !border !border-border !shadow-xl !rounded-lg !p-4 !z-50;
    width: 350px; /* Fixed width prevents it from stretching to full page */
    max-width: 90vw;
  }

  .mdxeditor-popup-container form {
    @apply !flex !flex-col !gap-2;
  }

  .mdxeditor-popup-container input {
    @apply !bg-background !border !border-input !text-foreground !rounded-md !px-3 !py-2 !text-sm;
  }

  .mdxeditor-popup-container button[type="submit"] {
    @apply !bg-primary !text-primary-foreground !rounded-md !px-4 !py-2 !text-sm !font-medium !mt-2;
  }
  .mdxeditor-popup-container button[type="button"] {
    @apply !hidden; /* Often the close button is redundant or breaks layout, hiding it is safer */
  }

  /* --- 4. CODE BLOCK VISIBILITY FIX (CRITICAL) --- */
  /* This ensures the 'prose' class doesn't mess up the CodeMirror text colors */

  .cm-editor {
    @apply !bg-secondary/50 !rounded-md !overflow-hidden !my-4;
  }

  /* Force the text color inside code blocks to be visible */
  .cm-scroller {
    @apply !font-mono !text-sm;
  }

  /* In Dark Mode, ensure code text is light */
  .dark-theme .cm-content {
    @apply !text-gray-100;
  }

  /* In Light Mode, ensure code text is dark */
  .mdxeditor-root:not(.dark-theme) .cm-content {
    @apply !text-gray-900;
  }

  /* Remove the weird prose padding from pre tags inside the editor */
  .prose pre {
    @apply !p-0 !bg-transparent !m-0 !rounded-none;
  }
}
